ProjectTest As screen:
    OnVisible: |-
        =Clear(ProjectsOfThisUser);
        
        ClearCollect(ProjectsOfThisUser,
            Filter(
                'CV Generator - Project Experience',
                Email = User().Email
            )
        )

    "'Rectangle - blue top panel_2' As rectangle":
        Fill: =RGBA(39, 41, 54, 1)
        Height: =116
        Width: =1366
        ZIndex: =1

    "'Capgemini Logo_1' As image":
        Height: =60
        Image: ='Logo Blue'
        Width: =52
        X: =1288
        Y: =29
        ZIndex: =2

    "'Label - Professional Experience_2' As label":
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Verdana
        FontWeight: =FontWeight.Semibold
        Height: =39
        Size: =24
        Text: ="Professional Experience"
        Width: =790
        X: =84
        Y: =37
        ZIndex: =3

    "'Icon - Circle with tick_1' As icon.CheckBadge":
        Color: =RGBA(255, 255, 255, 1)
        Icon: =Icon.CheckBadge
        X: =14
        Y: =27
        ZIndex: =4

    "'(Disabled Button) - blue background side panel_2' As button":
        Fill: =RGBA(39, 41, 54, 1)
        Height: =562
        HoverBorderColor: =
        HoverFill: =
        OnSelect: =
        PressedBorderColor: =
        Text: =""
        Width: =327
        X: =50
        Y: =145
        ZIndex: =5

    "'Label-Project Overview title_1' As label":
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Verdana
        FontWeight: =FontWeight.Semibold
        Size: =20
        Text: ="Project Overview"
        Width: =283
        X: =64
        Y: =174
        ZIndex: =6

    Experience1_2 As groupContainer:
        Height: =562
        Width: =959
        X: =395
        Y: =145
        ZIndex: =16

        "'1ProjectDescription_2' As text":
            Default: |
                =LookUp('CV Generator - Project Experience', ID = varSelectedProjectID, 'Project Description')
            Height: =246
            HintText: ="Description (Max 600 characters) "
            MaxLength: =600
            Mode: =TextMode.MultiLine
            Width: =848
            X: =40
            Y: =286
            ZIndex: =1

        "'Label-Project dates_1' As label":
            Font: =Font.Verdana
            Height: =33
            Size: =20
            Text: ="When were you on this project?"
            Width: =679
            X: =34
            Y: =150
            ZIndex: =6

        "'Checkbox - Current Project_1' As checkbox":
            CheckboxSize: =30
            Font: =Font.Verdana
            OnUncheck: =true
            Size: =11
            Text: ="Are you currently on this project?"
            Width: =265
            X: =391
            Y: =80
            ZIndex: =7

        "'1ProjectTitle_2' As text":
            Default: =If(varSelectedProjectID > 0, LookUp('CV Generator - Project Experience', ID = varSelectedProjectID, 'Project Title'), "")
            Font: =Font.Verdana
            Height: =45
            HintText: ="Project Title"
            OnChange: =Set(Project1ButtonText, '1ProjectTitle_2'.Text) 
            Width: =414
            X: =34
            Y: =15
            ZIndex: =11

        "'Label&DatePicker - Start_1' As group":
            Height: =5
            Width: =5
            X: =60
            Y: =60
            ZIndex: =11

            "'1ProjectStartDate_2' As datepicker":
                Font: =Font.Verdana
                Format: ="dd/mm/yyyy"
                StartOfWeek: =StartOfWeek.Monday
                X: =40
                Y: =232
                ZIndex: =2

            "'Label-StartDate_1' As label":
                Font: =Font.Verdana
                Text: ="Start date"
                X: =40
                Y: =195
                ZIndex: =4

        "'Label&DatePicker - End_1' As group":
            Height: =5
            Width: =5
            X: =60
            Y: =60
            ZIndex: =11

            "'1ProjectEndDate_2' As datepicker":
                DefaultDate: |
                    =If(varSelectedProjectID > 0, LookUp('CV Generator - Project Experience', ID = varSelectedProjectID, 'Start Date'), Today())
                Font: =Font.Verdana
                Format: |
                    ="dd/mm/yyyy"
                StartOfWeek: =StartOfWeek.Monday
                Visible: =!'Checkbox - Current Project_1'.Value
                X: =391
                Y: =232
                ZIndex: =3

            "'Label-EndDate_1' As label":
                Font: =Font.Verdana
                Text: ="End date"
                Visible: =!'Checkbox - Current Project_1'.Value
                X: =391
                Y: =195
                ZIndex: =5

        Dropdown2 As dropdown:
            Default: |
                =If(varSelectedProjectID > 0, LookUp('CV Generator - Project Experience', ID = varSelectedProjectID, 'Project Role'), "")
            Height: =45
            Items: |
                =["Product Owner",
                "Scrum Master",
                "Agile Coach",
                "Senior Business Analyst (BA)",
                "Business Analyst (BA)",
                "Product Manager",
                "Technical Lead",
                "Senior Developer",
                "Developer",
                "Junior Developer",
                "Quality Assurance (QA) Lead",
                "Quality Assurance (QA) Engineer",
                "UX/UI Lead",
                "UX/UI Designer",
                "DevOps Lead",
                "DevOps Engineer",
                "Database Administrator (DBA)",
                "Senior System Architect",
                "System Architect",
                "Release Manager",
                "Stakeholder",
                "Data Scientist",
                "Senior Cybersecurity Analyst",
                "Cybersecurity Analyst",
                "Cloud Architect",
                "Senior AI/Machine Learning Engineer",
                "AI/Machine Learning Engineer",
                "Blockchain Lead",
                "Blockchain Developer",
                "IoT Lead",
                "IoT Specialist",
                "Senior Environmental Sustainability Manager",
                "Environmental Sustainability Manager",
                "Carbon Emissions Lead Analyst",
                "Carbon Emissions Analyst",
                "Sustainable Design Lead Architect",
                "Sustainable Design Architect",
                "Senior Environmental Compliance Specialist",
                "Environmental Compliance Specialist",
                "Corporate Social Responsibility (CSR) Lead Manager",
                "Corporate Social Responsibility (CSR) Manager"]
            Width: =212
            X: =713
            Y: =16
            ZIndex: =12

        Dropdown3 As dropdown:
            Default: |
                =If(varSelectedProjectID > 0, LookUp('CV Generator - Project Experience', ID = varSelectedProjectID, 'Project Client'), "")
            Height: =45
            Items: |-
                =["HMRC (Her Majesty's Revenue and Customs)",
                "NHS (National Health Service)",
                "BAE (BAE Systems)",
                "Home Office",
                "MOD (Ministry of Defence)",
                "Metropolitan Police Service (MPS)",
                "Scottish Fire and Rescue Service",
                "HMCTS (Her Majesty's Courts and Tribunals Service)",
                "Veterinary Medicines Directorate",
                "Heathrow Airport",
                "Jaguar Land Rover",
                "Burberry",
                "Lloyd's Register",
                "EDF (Électricité de France)",
                "Bosch",
                "Royal Mail",
                "Met Search",
                "London Ambulance Service",
                "London Fire Brigade",
                "Welsh Assembly Government",
                "DWP (Department for Work and Pensions)",
                "MoJ (Ministry of Justice)",
                "DfE (Department for Education)",
                "DEFRA (Department for Environment, Food and Rural Affairs)",
                "Driver and Vehicle Standards Agency (DVSA)"
                ]
            Width: =213
            X: =470
            Y: =16
            ZIndex: =13

        "'1ProjectManager_1' As combobox":
            DefaultSelectedItems: |-
                =/*{
                        '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.Client_Data",
                        Claims: 
                            User().Email
                        ,
                        DisplayName: User().FullName,
                        Email: User().Email
                    } */
                {
                
                        '@odata.type': "#Microsoft.Azure.Connectors.SharePoint.'CV Generator'",
                
                        Claims: Concatenate(
                
                            "i:0#.f|membership|",
                
                            User().Email
                
                        ),
                
                        DisplayName: User().FullName,
                
                        Email: User().Email
                
                    } 
            DisplayFields: =["Claims"]
            Font: =Font.Verdana
            InputTextPlaceholder: ="Please select your manager" 
            Items: =Choices([@'CV Generator'].'Microsoft Profile')
            SearchFields: =["Claims"]
            SearchItems: =Choices('CV Generator'.'Microsoft Profile','1ProjectManager_1'.SearchText)
            SelectMultiple: |
                =false
            Template: =ListItemTemplate.Person
            Visible: |
                =true
            X: =34
            Y: =80
            ZIndex: =14

    "'Button-Submit_1' As button":
        OnSelect: |
            =If(
                varSelectedProjectID = 0,
                // Creating a new record because varSelectedProjectID = 0
                Patch(
                    'CV Generator - Project Experience',
                    Defaults('CV Generator - Project Experience'), // Indicates a new record
                    {
                        Email: User().Email,
                        'Project Title': '1ProjectTitle_2'.Text,
                        'Project Client': Dropdown3.Selected.Value,
                        'Project Role': Dropdown2.Selected.Value,
                        'Start Date': '1ProjectStartDate_2'.SelectedDate,
                        'End Date': '1ProjectEndDate_2'.SelectedDate,
                        'Project Description': '1ProjectDescription_2'.Text,
                        'Microsoft Profile': {
                            Claims: Concatenate("i:0#.f|membership|", User().Email),
                            Department: "",
                            DisplayName: User().FullName,
                            Email: User().Email,
                            JobTitle: "",
                            Picture: ""
                        }
                    }
                ),
                // Updating an existing record because varSelectedProjectID > 0
                Patch(
                    'CV Generator - Project Experience',
                    LookUp(
                        'CV Generator - Project Experience',
                        ID = varSelectedProjectID
                    ),
                    {
                        'Project Title': '1ProjectTitle_2'.Text,
                        'Project Client': Dropdown2.Selected.Value,
                        'Project Role': Dropdown3.Selected.Value,
                        'Start Date': '1ProjectStartDate_2'.SelectedDate,
                        'End Date': '1ProjectEndDate_2'.SelectedDate,
                        'Project Description': '1ProjectDescription_2'.Text,
                        'Microsoft Profile': {
                            Claims: Concatenate("i:0#.f|membership|", User().Email),
                            Department: "",
                            DisplayName: User().FullName,
                            Email: User().Email,
                            JobTitle: "",
                            Picture: ""
                        }
                    }
                )
            );
        Text: |-
            ="Submit
            "
        X: =1168
        Y: =699
        ZIndex: =17

    Gallery4 As gallery.galleryVertical:
        DelayItemLoading: =true
        Height: =493
        Items: |-
            =ProjectsOfThisUser
            //Lookup('CV Generator - Project Experience', Email=User().Email);
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplateSize: =50
        Width: =296
        X: =118
        Y: =214
        ZIndex: =21

        Button8 As button:
            BorderThickness: =0
            Color: =RGBA(0, 0, 0, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =35
            OnSelect: =Set(varSelectedProjectID, ThisItem.ID)
            Text: =ThisItem.'Project Title'
            Width: =273
            Y: =15
            ZIndex: =1

    Label15 As label:
        Color: =RGBA(255, 255, 255, 1)
        Height: =36
        Size: =26
        Text: =varSelectedProjectID
        X: =64
        Y: =663
        ZIndex: =22

    Button9 As button:
        OnSelect: =Set(varSelectedProjectID, 0)
        Text: ="New"
        X: =399
        Y: =699
        ZIndex: =23

    Icon8 As icon.Trash:
        Icon: =Icon.Trash
        OnSelect: |
            =RemoveIf('CV Generator - Project Experience', ID=varSelectedProjectID)
        X: =1264
        Y: =237
        ZIndex: =24

