Search As screen:
    OnVisible: |-
        =Clear(FinalFilteredCVs);
        Collect(FinalFilteredCVs, 'CV Generator');
        
        // Set checkboxes
        Set(BPSScheckedSearch, false);
        Set(SCcheckedSearch, false);
        
        ClearCollect(SkillsCollection, 
            //{Title: "Agile Concepts", ID: 1},
            {Title: "AWS", ID: 2},
            {Title: "Azure", ID: 3},
            {Title: "Devops & Tooling (e.g. Git, Jenkins)", ID: 4},
            {Title: "GCP", ID: 5},
            {Title: "RDBMS", ID: 6},
            {Title: "Graph DBs", ID: 7},
            {Title: "Hive", ID: 8},
            {Title: "Elasticsearch", ID: 9},
            {Title: "Databricks", ID: 10},
            {Title: "Dataiku", ID: 11},
            {Title: "Snowflake", ID: 12},
            {Title: "Teradata", ID: 13},
            {Title: "Data Robot", ID: 14},
            {Title: "Pandas", ID: 15},
            {Title: "Spark", ID: 16},
            {Title: "Airflow", ID: 17},
            {Title: "MLFlow", ID: 18},
            {Title: "Kedro", ID: 19},
            {Title: "TFX", ID: 20},
            {Title: "Scikit-Learn", ID: 21},
            {Title: "Tensorflow", ID: 22},
            {Title: "PyTorch", ID: 23},
            {Title: "Keras", ID: 24},
            {Title: "Looker", ID: 25},
            {Title: "Power BI", ID: 26},
            {Title: "Shiny", ID: 27},
            {Title: "Tableau", ID: 28},
            {Title: "React", ID: 29},
            {Title: "Flask", ID: 30},
            {Title: "HTML", ID: 31},
            {Title: ".NET", ID: 32},
            {Title: "Go", ID: 33},
            {Title: "JS", ID: 34},
            {Title: "Java / Scala", ID: 35},
            {Title: "Python", ID: 36},
            {Title: "R", ID: 37},
            {Title: "Rust", ID: 38},
            {Title: "Shell", ID: 39},
            {Title: "SQL", ID: 40}
        );
        
        ClearCollect(QualificationsCollection, 
            {Title: "Microsoft Certified: Azure Solutions Architect Expert", ID: 1},
            {Title: "Cisco Certified Network Associate (CCNA)", ID: 2},
            {Title: "CompTIA A+", ID: 3},
            {Title: "CompTIA Network+", ID: 4},
            {Title: "CompTIA Security+", ID: 5},
            {Title: "Certified Information Systems Security Professional (CISSP)", ID: 6},
            {Title: "Certified Ethical Hacker (CEH)", ID: 7},
            {Title: "AWS Certified Solutions Architect", ID: 8},
            {Title: "Google Certified Professional Cloud Architect", ID: 9},
            {Title: "Certified ScrumMaster (CSM)", ID: 10},
            {Title: "Certified Scrum Product Owner (CSPO)", ID: 11},
            {Title: "Project Management Professional (PMP)", ID: 12},
            {Title: "ITIL Foundation Certification", ID: 13},
            {Title: "Certified Information Security Manager (CISM)", ID: 14},
            {Title: "Certified Information Systems Auditor (CISA)", ID: 15},
            {Title: "VMware Certified Professional (VCP)", ID: 16},
            {Title: "Red Hat Certified Engineer (RHCE)", ID: 17},
            {Title: "Certified Kubernetes Administrator (CKA)", ID: 18},
            {Title: "Certified Docker Associate (CDA)", ID: 19},
            {Title: "Certified OpenStack Administrator (COA)", ID: 20},
            {Title: "Microsoft Certified: Azure Administrator Associate", ID: 21},
            {Title: "Microsoft Certified: Azure Developer Associate", ID: 22},
            {Title: "Google Associate Cloud Engineer", ID: 23},
            {Title: "Oracle Certified Professional (OCP)", ID: 24},
            {Title: "Certified Information Privacy Professional (CIPP)", ID: 25},
            {Title: "Certified Data Management Professional (CDMP)", ID: 26},
            {Title: "Certified Analytics Professional (CAP)", ID: 27},
            {Title: "Certified in Risk and Information Systems Control (CRISC)", ID: 28},
            {Title: "Certified Wireless Network Professional (CWNP)", ID: 29},
            {Title: "Certified Information Systems Security Officer (CISSO)", ID: 30},
            {Title: "Offensive Security Certified Professional (OSCP)", ID: 31},
            {Title: "Certified in Governance of Enterprise IT (CGEIT)", ID: 32},
            {Title: "Amazon Web Services Certified Developer (AWS CD)", ID: 33},
            {Title: "Certified Kubernetes Application Developer (CKAD)", ID: 34},
            {Title: "Google Professional Data Engineer", ID: 35},
            {Title: "Microsoft Certified: Data Analyst Associate", ID: 36},
            {Title: "Salesforce Certified Administrator", ID: 37},
            {Title: "Salesforce Certified Platform Developer", ID: 38},
            {Title: "Certified Cloud Security Professional (CCSP)", ID: 39},
            {Title: "Certified Cloud Architect (CCA)", ID: 40},
            {Title: "Certified Blockchain Professional (CBP)", ID: 41},
            {Title: "Certified Artificial Intelligence Professional (CAIP)", ID: 42},
            {Title: "Microsoft Certified: Power Platform App Maker Associate", ID: 43},
            {Title: "Microsoft Certified: Power Platform Developer Associate", ID: 44},
            {Title: "Certified Machine Learning Engineer", ID: 45},
            {Title: "Certified Big Data Professional (CBDP)", ID: 46},
            {Title: "Certified DevOps Engineer (CDE)", ID: 47},
            {Title: "Certified Cyber Forensics Professional (CCFP)", ID: 48},
            {Title: "Certified Mobile App Developer (CMAD)", ID: 49},
            {Title: "Certified 3D Printing Professional", ID: 50},
            {Title: "Certified Professional in Human Resources (PHR)", ID: 51},
            {Title: "Society for Human Resource Management Certified Professional (SHRM-CP)", ID: 52},
            {Title: "Certified Management Accountant (CMA)", ID: 53},
            {Title: "Certified Financial Planner (CFP)", ID: 54},
            {Title: "Chartered Financial Analyst (CFA)", ID: 55},
            {Title: "Six Sigma Green Belt", ID: 56}
        );

    "'(Disabled Button) - blue background side panel_1' As button":
        DisabledBorderColor: =RGBA(51, 51, 51, 1)
        DisabledColor: =RGBA(51, 51, 51, 1)
        Fill: =RGBA(39, 41, 54, 1)
        Height: =662
        HoverBorderColor: =
        HoverColor: =RGBA(51, 51, 51, 1)
        HoverFill: =
        OnSelect: =
        PressedBorderColor: =
        PressedColor: =RGBA(51, 51, 51, 1)
        PressedFill: =
        Text: =""
        Width: =367
        X: =110
        Y: =84
        ZIndex: =1

    "'Rectangle - blue top panel_1' As rectangle":
        Fill: =RGBA(39, 41, 54, 1)
        Height: =96
        Width: =1366
        ZIndex: =2

    "'Label - Professional Experience_1' As label":
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Verdana
        FontWeight: =FontWeight.Semibold
        Height: =43
        Size: =24
        Text: ="Search CVs"
        Width: =312
        X: =1054
        Y: =30
        ZIndex: =3

    GalleryFilteredCVs_1 As gallery.galleryVertical:
        DelayItemLoading: =true
        Height: =397
        Items: =FinalFilteredCVs
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplateSize: =75
        Width: =843
        X: =508
        Y: =228
        ZIndex: =4

        Label9_3 As label:
            Height: =53
            OnSelect: =Select(Parent)
            Text: |-
                =ThisItem.'First Name' & " " & ThisItem.'Last Name' & ", " & ThisItem.Capability & ", " & ThisItem.Hub
                // ThisItem.Photo & " " &
                //& ThisItem.SkillID & " " & " " & LookUp('Example Skills', ThisId=ThisItem.SkillID).Title 
            Width: =482
            X: =148
            ZIndex: =1

        Image1_1 As image:
            Height: =75
            Image: =ThisItem.Photo
            OnSelect: =Select(Parent)
            X: =15
            ZIndex: =2

    ButtonFilterCVs_1 As button:
        OnSelect: |
            =Clear(FinalFilteredCVs); // Clear the collection to start fresh
            Clear(FilteredEmailsForClient);
            Clear(FilteredClientsInIndustries);
            Clear(FilteredClientsInProjects);
            Clear(emails);
            
            // Generate a collection of emails which have projects with the selected clients
            ClearCollect(
                FilteredEmailsForClient,
                Filter(
                    'CV Generator - Project Experience',
                    'Project Client' in ComboBoxClient.SelectedItems.Value
                ).Email
            );
            
            //Collect the clients associated with these industries into a collection.
            
            ClearCollect(
                FilteredClientsInIndustries,
                Filter(
                    'CV Generator - Client/Industry',
                    Industry in ComboBoxIndustry.SelectedItems.Value
                ).Client
            );
            
            // Collect the emails of users who worked on a project with these clients
            ClearCollect(
                FilteredClientsInProjects,
                Filter(
                    'CV Generator - Project Experience',
                    'Project Client' in FilteredClientsInIndustries
                )
            );
            
            // make sure they are text
            ClearCollect(emails,
                ForAll(FilteredClientsInProjects, 
                    {email: Text(Email)}
                )
            );
            
            // Define variables for conditions
            Set(varIsSkillsEmpty, IsEmpty(ComboBoxSkillSearch_1.SelectedItems));
            Set(varIsQualificationsEmpty, IsEmpty(ComboBoxQualSearch_1.SelectedItems));
            Set(varIsRoleEmpty, IsEmpty(ComboBoxRole_1.SelectedItems));
            //Set(varIsCapabilityEmpty, Text(ComboBoxCapability.Selected.Value) = "All");
            Set(varIsRadioHubsEmpty, Len(RadioHubsSearch.SelectedText.Value) = 0);
            // Additional conditions can be set similarly
            
            // Conditional logic to handle both skills and qualifications
            If(
                varIsSkillsEmpty
                && varIsQualificationsEmpty
                && varIsRoleEmpty
                && !SCcheckedSearch
                && !BPSScheckedSearch,
                //&& varIsCapabilityEmpty
                //&& varIsRadioHubsEmpty
                Collect(FinalFilteredCVs, 'CV Generator'),
                Collect(
                    FinalFilteredCVs,
                    Filter(
                        'CV Generator',
                        // Filter by the industries of the CVs projects
                        //(IsEmpty(emails) || 
                        Email="hhhh",
                        //),
                        // Skill filter - ony apply if there are selected skills
                        (IsEmpty(ComboBoxSkillSearch_1.SelectedItems) || 
                            CountIf(
                                ComboBoxSkillSearch_1.SelectedItems,
                                !IsBlank(Find(Text(Title), SkillsString))
                            ) > 0),
                        // Qualification filter - only apply if there are selected qualifications
                        (IsEmpty(ComboBoxQualSearch_1.SelectedItems) || 
                            CountIf(
                                ComboBoxQualSearch_1.SelectedItems,
                                !IsBlank(Find(Text(Title), QualificationsString))
                            ) > 0),
                        // Role Title filter - only apply if role title selected
                        (IsEmpty(ComboBoxRole_1.SelectedItems) || 'Role Title' in ComboBoxRole_1.SelectedItems),
                        // Apply Security Clearance SC filter based on checkbox
                        (!SCcheckedSearch || (SCcheckedSearch && 'Security Clearance SC')),
                        // Apply Security Clearance BPSS filter based on checkbox
                        (!BPSScheckedSearch || (BPSScheckedSearch && 'Security Clearance BPSS'))
                        //(IsBlank(DropdownCapabilitySearch.Selected.Value) || Capability = Text(DropdownCapabilitySearch.Selected.Value))
                        //Hub = RadioHubsSearch.SelectedText.Value
                        
                    )
                )
            );
        Text: |-
            ="Search
            "
        X: =213
        Y: =687
        ZIndex: =9

    Icon5_3 As icon.Search:
        Color: =RGBA(255, 255, 255, 1)
        Height: =72
        Icon: =Icon.Search
        Width: =53
        X: =990
        Y: =16
        ZIndex: =14

    Profile_1 As label:
        Color: =RGBA(39, 41, 54, 1)
        Font: =Font.Verdana
        FontWeight: =FontWeight.Semibold
        Height: =122
        Size: =36
        Text: ="Your Profile"
        Visible: =false
        Width: =397
        X: =122
        Y: =130
        ZIndex: =15

    DropdownCapabilitySearch As dropdown:
        ChevronBackground: =RGBA(215, 223, 240, 1)
        ChevronFill: =RGBA(0, 18, 107, 1)
        Color: =RGBA(0, 18, 107, 1)
        Default: =""""""
        Fill: =RGBA(215, 223, 240, 1)
        Font: =Font.Verdana
        Items: =["", "Data & AI Strategy", "Data & AI Innovation", "Data & AI Factory", "Data & AI Enablement"]
        OnChange: =
        SelectionColor: =RGBA(0, 18, 107, 1)
        SelectionFill: =RGBA(215, 223, 240, 1)
        Size: =12
        X: =129
        Y: =212
        ZIndex: =16

    Group2 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =60
        ZIndex: =16

        ComboBoxSkillSearch_1 As combobox:
            DisplayFields: =["Skill"]
            InputTextPlaceholder: ="Filter skills"
            Items: =SkillsCollection
            SearchFields: =["Skill"]
            SearchItems: =Search(SkillsCollection,ComboBoxSkillSearch_1.SearchText,"Skill")
            X: =129
            Y: =424
            ZIndex: =5

        Label2_3 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: ="Skills"
            X: =129
            Y: =384
            ZIndex: =7

    "'Primary Alignment_2' As dropdown":
        ChevronBackground: =RGBA(215, 223, 240, 1)
        ChevronFill: =RGBA(0, 18, 107, 1)
        Color: =RGBA(0, 18, 107, 1)
        Fill: =RGBA(215, 223, 240, 1)
        Font: =Font.Verdana
        Items: |
            =["Primary Alignment","frog", "Intelligent Industry", "Corporate Experience", "W&O", "BT", "Analytics & AI", "Financial Service", "Manufacturing", "Automotive and Life Sciences", "Utilities & Energy", "TMTS", "Public Sector", "Consumer Products & Retail", "Sustainable Futures"]
        SelectionColor: =RGBA(0, 18, 107, 1)
        SelectionFill: =RGBA(215, 223, 240, 1)
        Size: =12
        Visible: =false
        X: =116
        Y: =182
        ZIndex: =17

    Group1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =60
        ZIndex: =17

        ComboBoxRole_1 As combobox:
            DisplayFields: =["Value"]
            InputTextPlaceholder: ="Filter Role"
            Items: =["Associate Consultant","Consultant", "Senior Consultant"]
            SearchFields: =["Value"]
            SearchItems: =Search(["Associate Consultant","Consultant", "Senior Consultant"],ComboBoxRole_1.SearchText,"Value")
            SelectMultiple: =false
            X: =129
            Y: =500
            ZIndex: =6

        Label2_4 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: ="Role"
            X: =129
            Y: =462
            ZIndex: =8

    Label9_1 As label:
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Verdana
        Text: |-
            ="Capability:"
        Width: =334
        X: =134
        Y: =172
        ZIndex: =18

    Group3 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =60
        ZIndex: =18

        ComboBoxQualSearch_1 As combobox:
            DisplayFields: =["Title"]
            InputTextPlaceholder: ="Filter Qualifications"
            Items: =QualificationsCollection
            SearchFields: =["Title"]
            SearchItems: =Search(QualificationsCollection,ComboBoxQualSearch_1.SearchText,"Title")
            X: =129
            Y: =580
            ZIndex: =10

        Label2_5 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: ="Qualifications"
            X: =129
            Y: =540
            ZIndex: =11

    Group4 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =60
        ZIndex: =19

        Checkbox_BPSS_Search_1 As checkbox:
            CheckboxSize: =30
            Color: =RGBA(255, 255, 255, 1)
            Height: =40
            OnCheck: =Set(BPSScheckedSearch,true)
            OnUncheck: =Set(BPSScheckedSearch,false)
            Text: ="BPSS"
            Width: =121
            X: =174
            Y: =633
            ZIndex: =12

        Checkbox_SC_Search_1 As checkbox:
            CheckboxSize: =30
            Color: =RGBA(255, 255, 255, 1)
            Height: =40
            OnCheck: =Set(SCcheckedSearch, true) 
            OnUncheck: =Set(SCcheckedSearch, false) 
            Text: ="SC"
            Width: =121
            X: =304
            Y: =633
            ZIndex: =13

    Label16 As label:
        Color: =RGBA(246, 88, 16, 1)
        Height: =159
        Text: |-
            =RadioHubsSearch.SelectedText.Value & " | len: " & Len(Text(RadioHubsSearch.SelectedText.Value))
        Width: =328
        X: =996
        Y: =540
        ZIndex: =21

    ComboBoxCapability As combobox:
        DisplayFields: =["Value"]
        IsSearchable: =false
        Items: =["All", "Data & AI Strategy", "Data & AI Innovation", "Data & AI Factory", "Data & AI Enablement"]
        SearchFields: =["Value"]
        SearchItems: =Search(["All", "Data & AI Strategy", "Data & AI Innovation", "Data & AI Factory", "Data & AI Enablement"],ComboBoxCapability.SearchText,"Value")
        SelectMultiple: =false
        Visible: =false
        X: =985
        Y: =190
        ZIndex: =22

    Label8 As label:
        Height: =74
        Text: |
            =If(IsEmpty(emails), "The collection is empty", "The collection has data")
        Width: =233
        X: =609
        Y: =625
        ZIndex: =23

    Group5_2 As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =23

        RadioHubsSearch As radio:
            Color: =RGBA(255, 255, 255, 1)
            HoverColor: =RGBA(219, 219, 219, 1)
            Items: |-
                =If(
                    IsBlank(DropdownCapabilitySearch.Selected),
                    [],
                    LookUp(HubOptionSets, Capability = DropdownCapabilitySearch.Selected.Value).Options
                )
            Width: =371
            X: =116
            Y: =284
            ZIndex: =19

        Label11_1 As label:
            Color: =RGBA(255, 255, 255, 1)
            Font: =Font.Verdana
            Text: |-
                ="Hub:"
            X: =134
            Y: =261
            ZIndex: =20

    ComboBoxClient As combobox:
        DisplayFields: =["Value"]
        Items: =["HMRC", "NHS", "BAE", "Home Office", "MOD", "Metropolitan Police Service (MPS)", "Scottish Fire and Rescue Service", "HMCTS", "DVSA", "Veterinary Medicines Directorate", "Heathrow Airport", "Jaguar Land Rover", "Burberry", "Lloyd's Register", "EDF", "Bosch", "Royal Mail", "Met Search", "London Ambulance Service", "London Fire Brigade", "National Security agencies", "multiple UK Police Forces", "Welish Assembly Government", "DWP", "MoJ", "DfE", "DEFRA", "Ministry of Justice (MoJ) on the HMCTS Reform Programme", "Driver and Vehicle Standards Agency (DVSA)"]
        SearchFields: =["Value"]
        SearchItems: =Search(["HMRC", "NHS", "BAE", "Home Office", "MOD", "Metropolitan Police Service (MPS)", "Scottish Fire and Rescue Service", "HMCTS", "DVSA", "Veterinary Medicines Directorate", "Heathrow Airport", "Jaguar Land Rover", "Burberry", "Lloyd's Register", "EDF", "Bosch", "Royal Mail", "Met Search", "London Ambulance Service", "London Fire Brigade", "National Security agencies", "multiple UK Police Forces", "Welish Assembly Government", "DWP", "MoJ", "DfE", "DEFRA", "Ministry of Justice (MoJ) on the HMCTS Reform Programme", "Driver and Vehicle Standards Agency (DVSA)"],ComboBoxClient.SearchText,"Value")
        X: =129
        Y: =127
        ZIndex: =24

    Gallery5 As gallery.galleryVertical:
        DelayItemLoading: =true
        Items: =emails
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplateSize: =95
        X: =711
        Y: =116
        ZIndex: =25

        Label18 As label:
            Height: =46
            OnSelect: =Select(Parent)
            Text: =ThisItem.email
            Width: =433
            X: =12
            Y: =24
            ZIndex: =1

        "Icon10 As icon.'3DPrinting'":
            Icon: =Icon.Printing3D
            OnSelect: =Select(Parent)
            X: =540
            Y: =24
            ZIndex: =2

    ComboBoxIndustry As combobox:
        DisplayFields: =["Value"]
        Items: |
            =["MALS", "CPRD", "Govt", "FS", "ET&U", "TMTS"]
        SearchFields: =["Value"]
        SearchItems: |-
            =Search(["MALS","CPRD", "Govt", "FS", "ET&U", "TMTS", "Central Govt"]
            ,ComboBoxIndustry.SearchText,"Value")
        X: =129
        Y: =49
        ZIndex: =26

    Label19 As label:
        Color: =RGBA(255, 255, 255, 1)
        Text: ="Client"
        X: =129
        Y: =90
        ZIndex: =27

    Label20 As label:
        Color: =RGBA(255, 255, 255, 1)
        Text: ="Industry"
        X: =127
        Y: =7
        ZIndex: =28

    Label14 As label:
        Text: |-
            ="# Rows: " & CountRows(Gallery5.AllItems)
        X: =1074
        Y: =706
        ZIndex: =29

