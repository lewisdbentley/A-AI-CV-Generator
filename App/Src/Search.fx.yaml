Search As screen:
    OnVisible: |-
        =Clear(FinalFilteredCVs);
        Collect(FinalFilteredCVs, 'CV Generator');
        
        ClearCollect(SkillsCollection, 
            //{Title: "Agile Concepts", ID: 1},
            {Title: "AWS", ID: 2},
            {Title: "Azure", ID: 3},
            {Title: "Devops & Tooling (e.g. Git, Jenkins)", ID: 4},
            {Title: "GCP", ID: 5},
            {Title: "RDBMS", ID: 6},
            {Title: "Graph DBs", ID: 7},
            {Title: "Hive", ID: 8},
            {Title: "Elasticsearch", ID: 9},
            {Title: "Databricks", ID: 10},
            {Title: "Dataiku", ID: 11},
            {Title: "Snowflake", ID: 12},
            {Title: "Teradata", ID: 13},
            {Title: "Data Robot", ID: 14},
            {Title: "Pandas", ID: 15},
            {Title: "Spark", ID: 16},
            {Title: "Airflow", ID: 17},
            {Title: "MLFlow", ID: 18},
            {Title: "Kedro", ID: 19},
            {Title: "TFX", ID: 20},
            {Title: "Scikit-Learn", ID: 21},
            {Title: "Tensorflow", ID: 22},
            {Title: "PyTorch", ID: 23},
            {Title: "Keras", ID: 24},
            {Title: "Looker", ID: 25},
            {Title: "Power BI", ID: 26},
            {Title: "Shiny", ID: 27},
            {Title: "Tableau", ID: 28},
            {Title: "React", ID: 29},
            {Title: "Flask", ID: 30},
            {Title: "HTML", ID: 31},
            {Title: ".NET", ID: 32},
            {Title: "Go", ID: 33},
            {Title: "JS", ID: 34},
            {Title: "Java / Scala", ID: 35},
            {Title: "Python", ID: 36},
            {Title: "R", ID: 37},
            {Title: "Rust", ID: 38},
            {Title: "Shell", ID: 39},
            {Title: "SQL", ID: 40}
        );
        
        ClearCollect(QualificationsCollection, 
            {Title: "Microsoft Certified: Azure Solutions Architect Expert", ID: 1},
            {Title: "Cisco Certified Network Associate (CCNA)", ID: 2},
            {Title: "CompTIA A+", ID: 3},
            {Title: "CompTIA Network+", ID: 4},
            {Title: "CompTIA Security+", ID: 5},
            {Title: "Certified Information Systems Security Professional (CISSP)", ID: 6},
            {Title: "Certified Ethical Hacker (CEH)", ID: 7},
            {Title: "AWS Certified Solutions Architect", ID: 8},
            {Title: "Google Certified Professional Cloud Architect", ID: 9},
            {Title: "Certified ScrumMaster (CSM)", ID: 10},
            {Title: "Certified Scrum Product Owner (CSPO)", ID: 11},
            {Title: "Project Management Professional (PMP)", ID: 12},
            {Title: "ITIL Foundation Certification", ID: 13},
            {Title: "Certified Information Security Manager (CISM)", ID: 14},
            {Title: "Certified Information Systems Auditor (CISA)", ID: 15},
            {Title: "VMware Certified Professional (VCP)", ID: 16},
            {Title: "Red Hat Certified Engineer (RHCE)", ID: 17},
            {Title: "Certified Kubernetes Administrator (CKA)", ID: 18},
            {Title: "Certified Docker Associate (CDA)", ID: 19},
            {Title: "Certified OpenStack Administrator (COA)", ID: 20},
            {Title: "Microsoft Certified: Azure Administrator Associate", ID: 21},
            {Title: "Microsoft Certified: Azure Developer Associate", ID: 22},
            {Title: "Google Associate Cloud Engineer", ID: 23},
            {Title: "Oracle Certified Professional (OCP)", ID: 24},
            {Title: "Certified Information Privacy Professional (CIPP)", ID: 25},
            {Title: "Certified Data Management Professional (CDMP)", ID: 26},
            {Title: "Certified Analytics Professional (CAP)", ID: 27},
            {Title: "Certified in Risk and Information Systems Control (CRISC)", ID: 28},
            {Title: "Certified Wireless Network Professional (CWNP)", ID: 29},
            {Title: "Certified Information Systems Security Officer (CISSO)", ID: 30},
            {Title: "Offensive Security Certified Professional (OSCP)", ID: 31},
            {Title: "Certified in Governance of Enterprise IT (CGEIT)", ID: 32},
            {Title: "Amazon Web Services Certified Developer (AWS CD)", ID: 33},
            {Title: "Certified Kubernetes Application Developer (CKAD)", ID: 34},
            {Title: "Google Professional Data Engineer", ID: 35},
            {Title: "Microsoft Certified: Data Analyst Associate", ID: 36},
            {Title: "Salesforce Certified Administrator", ID: 37},
            {Title: "Salesforce Certified Platform Developer", ID: 38},
            {Title: "Certified Cloud Security Professional (CCSP)", ID: 39},
            {Title: "Certified Cloud Architect (CCA)", ID: 40},
            {Title: "Certified Blockchain Professional (CBP)", ID: 41},
            {Title: "Certified Artificial Intelligence Professional (CAIP)", ID: 42},
            {Title: "Microsoft Certified: Power Platform App Maker Associate", ID: 43},
            {Title: "Microsoft Certified: Power Platform Developer Associate", ID: 44},
            {Title: "Certified Machine Learning Engineer", ID: 45},
            {Title: "Certified Big Data Professional (CBDP)", ID: 46},
            {Title: "Certified DevOps Engineer (CDE)", ID: 47},
            {Title: "Certified Cyber Forensics Professional (CCFP)", ID: 48},
            {Title: "Certified Mobile App Developer (CMAD)", ID: 49},
            {Title: "Certified 3D Printing Professional", ID: 50},
            {Title: "Certified Professional in Human Resources (PHR)", ID: 51},
            {Title: "Society for Human Resource Management Certified Professional (SHRM-CP)", ID: 52},
            {Title: "Certified Management Accountant (CMA)", ID: 53},
            {Title: "Certified Financial Planner (CFP)", ID: 54},
            {Title: "Chartered Financial Analyst (CFA)", ID: 55},
            {Title: "Six Sigma Green Belt", ID: 56}
        );

    "'(Disabled Button) - blue background side panel_1' As button":
        DisabledBorderColor: =RGBA(51, 51, 51, 1)
        DisabledColor: =RGBA(51, 51, 51, 1)
        Fill: =RGBA(39, 41, 54, 1)
        Height: =562
        HoverBorderColor: =
        HoverColor: =RGBA(51, 51, 51, 1)
        HoverFill: =
        OnSelect: =
        PressedBorderColor: =
        PressedColor: =RGBA(51, 51, 51, 1)
        PressedFill: =
        Text: =""
        Width: =367
        X: =110
        Y: =185
        ZIndex: =1

    "'Rectangle - blue top panel_1' As rectangle":
        Fill: =RGBA(39, 41, 54, 1)
        Height: =116
        Width: =1366
        Y: =40
        ZIndex: =2

    "'Label - Professional Experience_1' As label":
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Verdana
        FontWeight: =FontWeight.Semibold
        Height: =39
        Size: =24
        Text: ="Search CVs"
        Width: =790
        X: =164
        Y: =77
        ZIndex: =3

    "'Label-Project Overview title_1' As label":
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Verdana
        FontWeight: =FontWeight.Semibold
        Size: =20
        Text: ="Filter"
        Width: =283
        X: =151
        Y: =188
        ZIndex: =4

    GalleryFilteredCVs_1 As gallery.galleryVertical:
        DelayItemLoading: =true
        Height: =504
        Items: =FinalFilteredCVs
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplateSize: =75
        Width: =822
        X: =530
        Y: =228
        ZIndex: =5

        Label9_3 As label:
            Height: =53
            OnSelect: =Select(Parent)
            Text: |-
                =ThisItem.'First Name' & " " & ThisItem.'Last Name' & ", " & ThisItem.'Role Title'
                // ThisItem.Photo & " " &
                //& ThisItem.SkillID & " " & " " & LookUp('Example Skills', ThisId=ThisItem.SkillID).Title 
            Width: =482
            X: =148
            ZIndex: =1

        Image1_1 As image:
            Height: =75
            Image: =ThisItem.Photo
            OnSelect: =Select(Parent)
            X: =15
            ZIndex: =2

    ButtonFilterCVs_1 As button:
        OnSelect: |
            =Clear(FinalFilteredCVs); // Clear the collection to start fresh
            
            // Conditional logic to handle both skills and qualifications
            If(
                IsEmpty(ComboBoxSkillSearch_1.SelectedItems) && IsEmpty(ComboBoxQualSearch_1.SelectedItems) && IsEmpty(ComboBoxRole_1.SelectedItems) && !SCcheckedSearch && !BPSScheckedSearch,
                Collect(FinalFilteredCVs, 'CV Generator'),
                Collect(
                    FinalFilteredCVs,
                    Filter(
                        'CV Generator',
                        // Skill filter - only apply if there are selected skills
                        (IsEmpty(ComboBoxSkillSearch_1.SelectedItems) || 
                            CountIf(
                                ComboBoxSkillSearch_1.SelectedItems,
                                !IsBlank(Find(Text(Title), SkillsString))
                            ) > 0),
                        // Qualification filter - only apply if there are selected qualifications
                        (IsEmpty(ComboBoxQualSearch_1.SelectedItems) || 
                            CountIf(
                                ComboBoxQualSearch_1.SelectedItems,
                                !IsBlank(Find(Text(Title), QualificationsString))
                            ) > 0),
                        (IsEmpty(ComboBoxRole_1.SelectedItems) || 'Role Title' in ComboBoxRole_1.SelectedItems),
                        // Apply Security Clearance SC filter based on checkbox
                        (!SCcheckedSearch || (SCcheckedSearch && 'Security Clearance SC')),
                        // Apply Security Clearance BPSS filter based on checkbox
                        (!BPSScheckedSearch || (BPSScheckedSearch && 'Security Clearance BPSS'))
                    )
                )
            );
        Text: |-
            ="Search
            "
        X: =213
        Y: =663
        ZIndex: =10

    Icon5_3 As icon.Search:
        Color: =RGBA(255, 255, 255, 1)
        Icon: =Icon.Search
        X: =100
        Y: =60
        ZIndex: =15

    Group2 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =60
        ZIndex: =16

        ComboBoxSkillSearch_1 As combobox:
            DisplayFields: =["Title"]
            InputTextPlaceholder: ="Filter skills"
            Items: =SkillsCollection
            SearchFields: =["Title"]
            SearchItems: =Search(SkillsCollection,ComboBoxSkillSearch_1.SearchText,"Title")
            X: =130
            Y: =260
            ZIndex: =6

        Label2_3 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: ="Skills"
            X: =130
            Y: =220
            ZIndex: =8

    Group1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =60
        ZIndex: =17

        ComboBoxRole_1 As combobox:
            DisplayFields: =["Value"]
            InputTextPlaceholder: ="Filter Role"
            Items: =["Associate Consultant","Consultant", "Senior Consultant"]
            SearchFields: =["Value"]
            SearchItems: =Search(["Associate Consultant","Consultant", "Senior Consultant"],ComboBoxRole_1.SearchText,"Value")
            SelectMultiple: =false
            X: =130
            Y: =381
            ZIndex: =7

        Label2_4 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: ="Role"
            X: =130
            Y: =341
            ZIndex: =9

    Group3 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =60
        ZIndex: =18

        ComboBoxQualSearch_1 As combobox:
            DisplayFields: =["Title"]
            InputTextPlaceholder: ="Filter Qualifications"
            Items: =QualificationsCollection
            SearchFields: =["Title"]
            SearchItems: =Search(QualificationsCollection,ComboBoxQualSearch_1.SearchText,"Title")
            X: =129
            Y: =502
            ZIndex: =11

        Label2_5 As label:
            Color: =RGBA(255, 255, 255, 1)
            Text: ="Qualifications"
            X: =129
            Y: =462
            ZIndex: =12

    Group4 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =60
        ZIndex: =19

        Checkbox_BPSS_Search_1 As checkbox:
            CheckboxSize: =30
            Color: =RGBA(255, 255, 255, 1)
            Height: =40
            OnCheck: =Set(BPSScheckedSearch,true)
            OnUncheck: =Set(BPSScheckedSearch,false)
            Text: ="BPSS"
            Width: =121
            X: =168
            Y: =585
            ZIndex: =13

        Checkbox_SC_Search_1 As checkbox:
            CheckboxSize: =30
            Color: =RGBA(255, 255, 255, 1)
            Height: =40
            OnCheck: =Set(SCcheckedSearch, true) 
            OnUncheck: =Set(SCcheckedSearch, false) 
            Text: ="SC"
            Width: =121
            X: =298
            Y: =585
            ZIndex: =14

